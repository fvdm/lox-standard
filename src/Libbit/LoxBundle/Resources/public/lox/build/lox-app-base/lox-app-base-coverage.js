if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/lox-app-base/lox-app-base.js']) {
   __coverage__['build/lox-app-base/lox-app-base.js'] = {"path":"build/lox-app-base/lox-app-base.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":24},"end":{"line":1,"column":43}}},"2":{"name":"(anonymous_2)","line":72,"loc":{"start":{"line":72,"column":14},"end":{"line":72,"column":32}}},"3":{"name":"(anonymous_3)","line":101,"loc":{"start":{"line":101,"column":9},"end":{"line":101,"column":21}}},"4":{"name":"(anonymous_4)","line":119,"loc":{"start":{"line":119,"column":16},"end":{"line":119,"column":28}}},"5":{"name":"(anonymous_5)","line":127,"loc":{"start":{"line":127,"column":25},"end":{"line":127,"column":38}}},"6":{"name":"(anonymous_6)","line":133,"loc":{"start":{"line":133,"column":21},"end":{"line":133,"column":34}}},"7":{"name":"(anonymous_7)","line":141,"loc":{"start":{"line":141,"column":21},"end":{"line":141,"column":34}}},"8":{"name":"(anonymous_8)","line":145,"loc":{"start":{"line":145,"column":13},"end":{"line":145,"column":25}}},"9":{"name":"(anonymous_9)","line":149,"loc":{"start":{"line":149,"column":44},"end":{"line":149,"column":56}}},"10":{"name":"(anonymous_10)","line":164,"loc":{"start":{"line":164,"column":20},"end":{"line":164,"column":33}}},"11":{"name":"(anonymous_11)","line":170,"loc":{"start":{"line":170,"column":26},"end":{"line":170,"column":38}}},"12":{"name":"(anonymous_12)","line":177,"loc":{"start":{"line":177,"column":18},"end":{"line":177,"column":31}}},"13":{"name":"(anonymous_13)","line":183,"loc":{"start":{"line":183,"column":17},"end":{"line":183,"column":29}}},"14":{"name":"(anonymous_14)","line":193,"loc":{"start":{"line":193,"column":25},"end":{"line":193,"column":38}}},"15":{"name":"(anonymous_15)","line":206,"loc":{"start":{"line":206,"column":26},"end":{"line":206,"column":38}}},"16":{"name":"(anonymous_16)","line":215,"loc":{"start":{"line":215,"column":26},"end":{"line":215,"column":43}}},"17":{"name":"(anonymous_17)","line":228,"loc":{"start":{"line":228,"column":22},"end":{"line":228,"column":35}}},"18":{"name":"(anonymous_18)","line":233,"loc":{"start":{"line":233,"column":13},"end":{"line":233,"column":25}}},"19":{"name":"(anonymous_19)","line":240,"loc":{"start":{"line":240,"column":21},"end":{"line":240,"column":34}}},"20":{"name":"(anonymous_20)","line":251,"loc":{"start":{"line":251,"column":5},"end":{"line":251,"column":17}}},"21":{"name":"(anonymous_21)","line":252,"loc":{"start":{"line":252,"column":35},"end":{"line":252,"column":47}}},"22":{"name":"(anonymous_22)","line":264,"loc":{"start":{"line":264,"column":16},"end":{"line":264,"column":28}}},"23":{"name":"(anonymous_23)","line":267,"loc":{"start":{"line":267,"column":24},"end":{"line":267,"column":36}}},"24":{"name":"(anonymous_24)","line":274,"loc":{"start":{"line":274,"column":17},"end":{"line":274,"column":43}}},"25":{"name":"(anonymous_25)","line":285,"loc":{"start":{"line":285,"column":13},"end":{"line":285,"column":25}}},"26":{"name":"(anonymous_26)","line":293,"loc":{"start":{"line":293,"column":18},"end":{"line":293,"column":44}}},"27":{"name":"(anonymous_27)","line":307,"loc":{"start":{"line":307,"column":19},"end":{"line":307,"column":34}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":341,"column":88}},"2":{"start":{"line":11,"column":0},"end":{"line":20,"column":56}},"3":{"start":{"line":30,"column":0},"end":{"line":335,"column":3}},"4":{"start":{"line":73,"column":2},"end":{"line":73,"column":26}},"5":{"start":{"line":75,"column":2},"end":{"line":75,"column":57}},"6":{"start":{"line":77,"column":2},"end":{"line":96,"column":5}},"7":{"start":{"line":102,"column":2},"end":{"line":108,"column":3}},"8":{"start":{"line":103,"column":3},"end":{"line":103,"column":19}},"9":{"start":{"line":105,"column":3},"end":{"line":107,"column":6}},"10":{"start":{"line":110,"column":2},"end":{"line":110,"column":14}},"11":{"start":{"line":120,"column":2},"end":{"line":120,"column":42}},"12":{"start":{"line":122,"column":2},"end":{"line":124,"column":5}},"13":{"start":{"line":128,"column":8},"end":{"line":128,"column":26}},"14":{"start":{"line":130,"column":8},"end":{"line":130,"column":28}},"15":{"start":{"line":134,"column":2},"end":{"line":134,"column":22}},"16":{"start":{"line":136,"column":8},"end":{"line":138,"column":11}},"17":{"start":{"line":142,"column":2},"end":{"line":143,"column":16}},"18":{"start":{"line":145,"column":2},"end":{"line":161,"column":5}},"19":{"start":{"line":146,"column":3},"end":{"line":160,"column":4}},"20":{"start":{"line":147,"column":4},"end":{"line":147,"column":39}},"21":{"start":{"line":149,"column":4},"end":{"line":153,"column":7}},"22":{"start":{"line":150,"column":5},"end":{"line":152,"column":8}},"23":{"start":{"line":155,"column":4},"end":{"line":159,"column":7}},"24":{"start":{"line":165,"column":2},"end":{"line":165,"column":21}},"25":{"start":{"line":167,"column":8},"end":{"line":174,"column":11}},"26":{"start":{"line":171,"column":5},"end":{"line":171,"column":21}},"27":{"start":{"line":178,"column":2},"end":{"line":181,"column":20}},"28":{"start":{"line":183,"column":2},"end":{"line":189,"column":5}},"29":{"start":{"line":184,"column":3},"end":{"line":188,"column":6}},"30":{"start":{"line":194,"column":2},"end":{"line":198,"column":16}},"31":{"start":{"line":200,"column":2},"end":{"line":200,"column":22}},"32":{"start":{"line":202,"column":8},"end":{"line":225,"column":5}},"33":{"start":{"line":207,"column":5},"end":{"line":207,"column":25}},"34":{"start":{"line":209,"column":5},"end":{"line":213,"column":8}},"35":{"start":{"line":216,"column":20},"end":{"line":216,"column":77}},"36":{"start":{"line":218,"column":5},"end":{"line":222,"column":8}},"37":{"start":{"line":229,"column":2},"end":{"line":230,"column":16}},"38":{"start":{"line":233,"column":2},"end":{"line":237,"column":5}},"39":{"start":{"line":234,"column":3},"end":{"line":234,"column":23}},"40":{"start":{"line":236,"column":3},"end":{"line":236,"column":23}},"41":{"start":{"line":241,"column":2},"end":{"line":242,"column":16}},"42":{"start":{"line":244,"column":2},"end":{"line":244,"column":22}},"43":{"start":{"line":246,"column":2},"end":{"line":261,"column":5}},"44":{"start":{"line":252,"column":3},"end":{"line":260,"column":6}},"45":{"start":{"line":253,"column":4},"end":{"line":257,"column":7}},"46":{"start":{"line":259,"column":4},"end":{"line":259,"column":24}},"47":{"start":{"line":265,"column":2},"end":{"line":265,"column":18}},"48":{"start":{"line":267,"column":2},"end":{"line":269,"column":5}},"49":{"start":{"line":268,"column":3},"end":{"line":268,"column":64}},"50":{"start":{"line":275,"column":2},"end":{"line":277,"column":15}},"51":{"start":{"line":279,"column":2},"end":{"line":290,"column":3}},"52":{"start":{"line":280,"column":3},"end":{"line":280,"column":19}},"53":{"start":{"line":281,"column":3},"end":{"line":281,"column":10}},"54":{"start":{"line":283,"column":3},"end":{"line":283,"column":46}},"55":{"start":{"line":285,"column":3},"end":{"line":289,"column":6}},"56":{"start":{"line":286,"column":4},"end":{"line":286,"column":27}},"57":{"start":{"line":287,"column":4},"end":{"line":287,"column":20}},"58":{"start":{"line":288,"column":4},"end":{"line":288,"column":11}},"59":{"start":{"line":294,"column":2},"end":{"line":295,"column":35}},"60":{"start":{"line":297,"column":2},"end":{"line":297,"column":26}},"61":{"start":{"line":299,"column":2},"end":{"line":304,"column":3}},"62":{"start":{"line":300,"column":3},"end":{"line":300,"column":10}},"63":{"start":{"line":302,"column":3},"end":{"line":302,"column":58}},"64":{"start":{"line":303,"column":3},"end":{"line":303,"column":10}},"65":{"start":{"line":308,"column":8},"end":{"line":311,"column":11}},"66":{"start":{"line":338,"column":0},"end":{"line":338,"column":29}}},"branchMap":{"1":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":2},"end":{"line":73,"column":8}},{"start":{"line":73,"column":13},"end":{"line":73,"column":24}}]},"2":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":2},"end":{"line":102,"column":2}},{"start":{"line":102,"column":2},"end":{"line":102,"column":2}}]},"3":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":3},"end":{"line":146,"column":3}},{"start":{"line":146,"column":3},"end":{"line":146,"column":3}}]},"4":{"line":179,"type":"cond-expr","locations":[{"start":{"line":179,"column":77},"end":{"line":179,"column":83}},{"start":{"line":179,"column":86},"end":{"line":179,"column":92}}]},"5":{"line":179,"type":"binary-expr","locations":[{"start":{"line":179,"column":16},"end":{"line":179,"column":45}},{"start":{"line":179,"column":49},"end":{"line":179,"column":73}}]},"6":{"line":196,"type":"cond-expr","locations":[{"start":{"line":196,"column":35},"end":{"line":196,"column":37}},{"start":{"line":196,"column":40},"end":{"line":196,"column":51}}]},"7":{"line":197,"type":"cond-expr","locations":[{"start":{"line":197,"column":31},"end":{"line":197,"column":48}},{"start":{"line":197,"column":51},"end":{"line":197,"column":68}}]},"8":{"line":210,"type":"cond-expr","locations":[{"start":{"line":210,"column":33},"end":{"line":210,"column":49}},{"start":{"line":210,"column":52},"end":{"line":210,"column":69}}]},"9":{"line":211,"type":"cond-expr","locations":[{"start":{"line":211,"column":33},"end":{"line":211,"column":48}},{"start":{"line":211,"column":51},"end":{"line":211,"column":67}}]},"10":{"line":216,"type":"binary-expr","locations":[{"start":{"line":216,"column":30},"end":{"line":216,"column":44}},{"start":{"line":216,"column":48},"end":{"line":216,"column":76}}]},"11":{"line":279,"type":"if","locations":[{"start":{"line":279,"column":2},"end":{"line":279,"column":2}},{"start":{"line":279,"column":2},"end":{"line":279,"column":2}}]},"12":{"line":279,"type":"binary-expr","locations":[{"start":{"line":279,"column":6},"end":{"line":279,"column":31}},{"start":{"line":279,"column":35},"end":{"line":279,"column":48}}]},"13":{"line":299,"type":"if","locations":[{"start":{"line":299,"column":2},"end":{"line":299,"column":2}},{"start":{"line":299,"column":2},"end":{"line":299,"column":2}}]}},"code":["(function () { YUI.add('lox-app-base', function (Y, NAME) {","","/*jshint expr:true, onevar:false */","","/**","The filemanager app.","","@module lox-app","@submodule lox-app-base","**/","var TEXT_TITLE_ERROR    = 'Error',","\tTEXT_TITLE_COPIED   = 'Copied',","\tTEXT_ITEM_COPIED    = 'Item successfully copied.',","\tTEXT_TITLE_MOVED    = 'Moved',","\tTEXT_ITEM_MOVED     = 'Item successfully moved.',","\tTEXT_UNSHARE        = 'Unshare',","\tTEXT_UNSHARE_TITLE  = 'Unshare folder \\'{item}\\'?',","\tTEXT_UNSHARE_BODY   = 'The folder will no longer be shared and will be visible to only you. Are you sure you want to stop sharing?',","\tTEXT_TITLE_UNSHARED = 'Share removed',","\tTEXT_ITEM_UNSHARED  = 'The folder is no longer shared';","","/**","The filemanager app.","","@class App","@namespace Lox","@constructor","@extends Rednose.App","**/","var App = Y.Base.create('app', Y.Rednose.App, [], {","","\tviews: {","\t\titemView: {","\t\t\ttype: 'Lox.App.FileBrowserView'","\t\t},","","\t\tuploadView: {","\t\t\ttype  : 'Lox.App.FileUploadView',","\t\t\tparent: 'itemView',","            width : '640px',","            height: '250px',","\t\t\tmodal : true","\t\t},","","\t\tdetailView: {","\t\t\ttype  : 'Lox.App.FileDetailView',","\t\t\tparent: 'itemView',","            width : '500px',","            height: '300px',","\t\t\tmodal : true","\t\t},","","\t\tmoveCopyView: {","\t\t\ttype  : 'Lox.App.FileMoveCopyView',","\t\t\tparent: 'itemView',","            width : '500px',","            height: '400px',","\t\t\tmodal : true","\t\t},","","\t\tfolderShareView: {","\t\t\ttype  : 'Lox.App.FolderShareView',","\t\t\tparent: 'itemView',","            width : '640px',","            height: '400px',","\t\t\tmodal : true","\t\t}","\t},","","\t// -- Lifecycle Methods ----------------------------------------------------","","\tinitializer: function (config) {","\t\tconfig || (config = {});","","\t\tnew Y.Rednose.Tooltip({ selector : '*[rel=tooltip]' });","","\t\tthis.on({","\t\t\t'*:buttonClose'   : this.popModalView,","\t\t\t'*:buttonCancel'  : this.popModalView,","","\t\t\t'*:reload'        : this._handleReload,","\t\t\t'*:uploadcomplete': this._handleReload,","","\t\t\t'*:navigateItem'  : this._navigateToItemView,","\t\t\t'*:showItemDetail': this._showDetailItem,","\t\t\t'*:upload'        : this._handleUpload,","","\t\t\t'*:leave': this._handleLeaveShare,","\t\t\t'*:share': this._handleShareFolder,","\t\t\t'*:move' : this._handleMoveCopy,","\t\t\t'*:copy' : this._handleMoveCopy,","","\t\t\t'fileMoveCopyView:buttonConfirm': this._handleMoveCopyConfirm,","\t\t\t'folderShareView:buttonConfirm' : this._handleShareConfirm,","\t\t\t'folderShareView:buttonRemove'  : this._handleShareRemove","\t\t});","    },","","\t// -- Public Methods -------------------------------------------------------","","\trender: function () {","\t\tif (this.hasRoute(this.getPath())) {","\t\t\tthis.dispatch();","\t\t} else {","\t\t\tthis.showView('itemView', {","\t\t\t\tmodelList: this.get('item')","\t\t\t});","\t\t}","","\t\treturn this;","\t},","","\t// -- Protected Event Handlers ----------------------------------------------","","\t/**","\t@method _handleUpload","\t@protected","\t**/","\t_handleUpload: function () {","\t\tvar path = this.get('item').get('path');","","\t\tthis.showView('uploadView', {","\t\t\tpath: path","\t\t});","\t},","","    _navigateToItemView: function (e) {","        var path = e.path;","","        this.navigate(path);","    },","","    _showDetailItem: function (e) {","\t\tvar model = e.model;","","        this.showView('detailView', {","            model: model","        });","    },","","\t_handleShareFolder: function (e) {","\t\tvar model = e.data,","\t\t\tself  = this;","","\t\tmodel.load(function () {","\t\t\tif (model.get('isShared')) {","\t\t\t\tvar share = new Y.Lox.ShareModel();","","\t\t\t\tshare.load({ path: model.get('path') }, function () {","\t\t\t\t\tself.showView('folderShareView', {","\t\t\t\t\t\tmodel: share","\t\t\t\t\t});","\t\t\t\t});","\t\t\t} else {","\t\t\t\tself.showView('folderShareView', {","\t\t\t\t\tmodel: new Y.Lox.ShareModel({","\t\t\t\t\t\titem: model","\t\t\t\t\t})","\t\t\t\t});","\t\t\t}","\t\t});","\t},","","\t_handleLeaveShare: function (e) {","\t\tvar model = e.data;","","        Y.io(YUI.Env.routing.shares_base + model.get('path') + '/leave', {","            method: 'POST',","            on: {","                success : function () {","\t\t\t\t\tmodel.destroy();","                }","            }","        });","\t},","","\t_handleMoveCopy: function (e) {","\t\tvar model     = e.data,","\t\t\ttype      = (e.type === 'contextMenu:move' || e.type === 'navbar:move') ? 'move' : 'copy',","\t\t\tmodelTree = new Y.Lox.App.FolderTree(),","\t\t\tself      = this;","","\t\tmodelTree.load(function () {","\t\t\tself.showView('moveCopyView', {","\t\t\t\ttype     : type,","\t\t\t\tmodel    : model,","\t\t\t\tmodelTree: modelTree","\t\t\t});","\t\t});","\t},","","\t// TODO: Prevent folder recursion.","\t_handleMoveCopyConfirm: function (e) {","\t\tvar type  = e.data.type,","\t\t\tmodel = e.data.model,","\t\t\tpath  = (e.data.path === '/') ? '' : e.data.path,","\t\t\troute = (type === 'move') ? 'operations_move' : 'operations_copy',","\t\t\tself  = this;","","\t\tthis.popModalView();","","        Y.io(YUI.Env.routing[route], {","            method: 'POST',","            data: { 'from_path': model.get('path'), 'to_path': path + '/' + model.get('title') },","            on : {","                success : function () {","\t\t\t\t\tself.fire('reload');","","\t\t\t\t\tY.Rednose.Notifier.notify({","\t\t\t\t\t\ttitle: (type === 'move') ? TEXT_TITLE_MOVED : TEXT_TITLE_COPIED,","\t\t\t\t\t\ttext : (type === 'move') ? TEXT_ITEM_MOVED : TEXT_ITEM_COPIED,","\t\t\t\t\t\ttype : 'success'","\t\t\t\t\t});","                },","                failure : function (tx, r) {","                    var err = r.responseText && Y.JSON.parse(r.responseText);","","\t\t\t\t\tY.Rednose.Notifier.notify({","\t\t\t\t\t\ttitle: TEXT_TITLE_ERROR,","\t\t\t\t\t\ttext : err.error,","\t\t\t\t\t\ttype : 'error'","\t\t\t\t\t});","                }","            }","\t\t});","\t},","","\t_handleShareConfirm: function (e) {","\t\tvar model = e.data.model,","\t\t\tself  = this;","","\t\t// TODO: Show spinner.","\t\tmodel.save(function () {","\t\t\tself.popModalView();","","\t\t\tself.fire('reload');","\t\t});","\t},","","\t_handleShareRemove: function (e) {","\t\tvar model = e.data.model,","\t\t\tself  = this;","","\t\tthis.popModalView();","","\t\tY.Rednose.Dialog.confirm({","\t\t\ttitle  : Y.Lang.sub(TEXT_UNSHARE_TITLE, { item: model.get('item').get('title') }),","\t\t\ttext   : TEXT_UNSHARE_BODY,","\t\t\tconfirm: TEXT_UNSHARE,","\t\t\ttype   : 'warning'","\t\t}, function () {","\t\t\tmodel.destroy({ remove: true }, function () {","\t\t\t\tY.Rednose.Notifier.notify({","\t\t\t\t\ttitle: TEXT_TITLE_UNSHARED,","\t\t\t\t\ttext : TEXT_ITEM_UNSHARED,","\t\t\t\t\ttype : 'success'","\t\t\t\t});","","\t\t\t\tself.fire('reload');","\t\t\t});","\t\t});","\t},","","\t_handleReload: function () {","\t\tvar self = this;","","\t\tthis.get('item').load(function () {","\t\t\tself.get('children').reset(self.get('item').get('children'));","\t\t});","\t},","","\t// -- Route Handlers -------------------------------------------------------","","    _handleItem: function (req, res, next) {","\t\tvar path = req.path,","\t\t\titem = this.get('item'),","\t\t\tself = this;","","\t\tif (path === item.get('path') && !item.isNew()) {","\t\t\treq.item = item;","\t\t\tnext();","\t\t} else {","\t\t\titem = new Y.Lox.ItemModel({ path: path });","","\t\t\titem.load(function () {","\t\t\t\tself.set('item', item);","\t\t\t\treq.item = item;","\t\t\t\tnext();","\t\t\t});","\t\t}","\t},","","\t_handleChildren: function (req, res, next) {","\t\tvar item     = req.item,","\t\t\tchildren = this.get('children');","","\t\treq.children = children;","","\t\tif (item === children.get('item')) {","\t\t\tnext();","\t\t} else {","\t\t\tchildren.set('item', item).reset(item.get('children'));","\t\t\tnext();","\t\t}","\t},","","    _showItemPage: function (req) {","        this.showView('itemView', {","            model    : req.item,","            modelList: req.children","        });","    }","}, {","\tATTRS: {","        item    : { value: new Y.Lox.ItemModel() },","        children: { value: new Y.ModelList({ model: Y.Lox.ItemModel })},","","\t\troot: {","\t\t\tvalue: YUI.Env.routing.home","\t\t},","","\t\troutes: {","\t\t\tvalue: [","\t\t\t\t{","\t\t\t\t\tpath: '/*',","\t\t\t\t\tcallbacks: [","\t\t\t\t\t\t'_handleItem',","\t\t\t\t\t\t'_handleChildren',","\t\t\t\t\t\t'_showItemPage'","\t\t\t\t\t]","\t\t\t\t}","\t\t\t]","\t\t}","\t}","});","","// -- Namespace ----------------------------------------------------------------","Y.namespace('Lox').App = App;","","","}, '@VERSION@', {\"requires\": [\"lox-app-item-model\", \"rednose-app\", \"rednose-tooltip\"]});","","}());"]};
}
var __cov_EPeJQXLPxq_qER$ceGa55g = __coverage__['build/lox-app-base/lox-app-base.js'];
__cov_EPeJQXLPxq_qER$ceGa55g.s['1']++;YUI.add('lox-app-base',function(Y,NAME){__cov_EPeJQXLPxq_qER$ceGa55g.f['1']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['2']++;var TEXT_TITLE_ERROR='Error',TEXT_TITLE_COPIED='Copied',TEXT_ITEM_COPIED='Item successfully copied.',TEXT_TITLE_MOVED='Moved',TEXT_ITEM_MOVED='Item successfully moved.',TEXT_UNSHARE='Unshare',TEXT_UNSHARE_TITLE='Unshare folder \'{item}\'?',TEXT_UNSHARE_BODY='The folder will no longer be shared and will be visible to only you. Are you sure you want to stop sharing?',TEXT_TITLE_UNSHARED='Share removed',TEXT_ITEM_UNSHARED='The folder is no longer shared';__cov_EPeJQXLPxq_qER$ceGa55g.s['3']++;var App=Y.Base.create('app',Y.Rednose.App,[],{views:{itemView:{type:'Lox.App.FileBrowserView'},uploadView:{type:'Lox.App.FileUploadView',parent:'itemView',width:'640px',height:'250px',modal:true},detailView:{type:'Lox.App.FileDetailView',parent:'itemView',width:'500px',height:'300px',modal:true},moveCopyView:{type:'Lox.App.FileMoveCopyView',parent:'itemView',width:'500px',height:'400px',modal:true},folderShareView:{type:'Lox.App.FolderShareView',parent:'itemView',width:'640px',height:'400px',modal:true}},initializer:function(config){__cov_EPeJQXLPxq_qER$ceGa55g.f['2']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['4']++;(__cov_EPeJQXLPxq_qER$ceGa55g.b['1'][0]++,config)||(__cov_EPeJQXLPxq_qER$ceGa55g.b['1'][1]++,config={});__cov_EPeJQXLPxq_qER$ceGa55g.s['5']++;new Y.Rednose.Tooltip({selector:'*[rel=tooltip]'});__cov_EPeJQXLPxq_qER$ceGa55g.s['6']++;this.on({'*:buttonClose':this.popModalView,'*:buttonCancel':this.popModalView,'*:reload':this._handleReload,'*:uploadcomplete':this._handleReload,'*:navigateItem':this._navigateToItemView,'*:showItemDetail':this._showDetailItem,'*:upload':this._handleUpload,'*:leave':this._handleLeaveShare,'*:share':this._handleShareFolder,'*:move':this._handleMoveCopy,'*:copy':this._handleMoveCopy,'fileMoveCopyView:buttonConfirm':this._handleMoveCopyConfirm,'folderShareView:buttonConfirm':this._handleShareConfirm,'folderShareView:buttonRemove':this._handleShareRemove});},render:function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['3']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['7']++;if(this.hasRoute(this.getPath())){__cov_EPeJQXLPxq_qER$ceGa55g.b['2'][0]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['8']++;this.dispatch();}else{__cov_EPeJQXLPxq_qER$ceGa55g.b['2'][1]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['9']++;this.showView('itemView',{modelList:this.get('item')});}__cov_EPeJQXLPxq_qER$ceGa55g.s['10']++;return this;},_handleUpload:function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['4']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['11']++;var path=this.get('item').get('path');__cov_EPeJQXLPxq_qER$ceGa55g.s['12']++;this.showView('uploadView',{path:path});},_navigateToItemView:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['5']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['13']++;var path=e.path;__cov_EPeJQXLPxq_qER$ceGa55g.s['14']++;this.navigate(path);},_showDetailItem:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['6']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['15']++;var model=e.model;__cov_EPeJQXLPxq_qER$ceGa55g.s['16']++;this.showView('detailView',{model:model});},_handleShareFolder:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['7']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['17']++;var model=e.data,self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['18']++;model.load(function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['8']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['19']++;if(model.get('isShared')){__cov_EPeJQXLPxq_qER$ceGa55g.b['3'][0]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['20']++;var share=new Y.Lox.ShareModel();__cov_EPeJQXLPxq_qER$ceGa55g.s['21']++;share.load({path:model.get('path')},function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['9']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['22']++;self.showView('folderShareView',{model:share});});}else{__cov_EPeJQXLPxq_qER$ceGa55g.b['3'][1]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['23']++;self.showView('folderShareView',{model:new Y.Lox.ShareModel({item:model})});}});},_handleLeaveShare:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['10']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['24']++;var model=e.data;__cov_EPeJQXLPxq_qER$ceGa55g.s['25']++;Y.io(YUI.Env.routing.shares_base+model.get('path')+'/leave',{method:'POST',on:{success:function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['11']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['26']++;model.destroy();}}});},_handleMoveCopy:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['12']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['27']++;var model=e.data,type=(__cov_EPeJQXLPxq_qER$ceGa55g.b['5'][0]++,e.type==='contextMenu:move')||(__cov_EPeJQXLPxq_qER$ceGa55g.b['5'][1]++,e.type==='navbar:move')?(__cov_EPeJQXLPxq_qER$ceGa55g.b['4'][0]++,'move'):(__cov_EPeJQXLPxq_qER$ceGa55g.b['4'][1]++,'copy'),modelTree=new Y.Lox.App.FolderTree(),self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['28']++;modelTree.load(function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['13']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['29']++;self.showView('moveCopyView',{type:type,model:model,modelTree:modelTree});});},_handleMoveCopyConfirm:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['14']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['30']++;var type=e.data.type,model=e.data.model,path=e.data.path==='/'?(__cov_EPeJQXLPxq_qER$ceGa55g.b['6'][0]++,''):(__cov_EPeJQXLPxq_qER$ceGa55g.b['6'][1]++,e.data.path),route=type==='move'?(__cov_EPeJQXLPxq_qER$ceGa55g.b['7'][0]++,'operations_move'):(__cov_EPeJQXLPxq_qER$ceGa55g.b['7'][1]++,'operations_copy'),self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['31']++;this.popModalView();__cov_EPeJQXLPxq_qER$ceGa55g.s['32']++;Y.io(YUI.Env.routing[route],{method:'POST',data:{'from_path':model.get('path'),'to_path':path+'/'+model.get('title')},on:{success:function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['15']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['33']++;self.fire('reload');__cov_EPeJQXLPxq_qER$ceGa55g.s['34']++;Y.Rednose.Notifier.notify({title:type==='move'?(__cov_EPeJQXLPxq_qER$ceGa55g.b['8'][0]++,TEXT_TITLE_MOVED):(__cov_EPeJQXLPxq_qER$ceGa55g.b['8'][1]++,TEXT_TITLE_COPIED),text:type==='move'?(__cov_EPeJQXLPxq_qER$ceGa55g.b['9'][0]++,TEXT_ITEM_MOVED):(__cov_EPeJQXLPxq_qER$ceGa55g.b['9'][1]++,TEXT_ITEM_COPIED),type:'success'});},failure:function(tx,r){__cov_EPeJQXLPxq_qER$ceGa55g.f['16']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['35']++;var err=(__cov_EPeJQXLPxq_qER$ceGa55g.b['10'][0]++,r.responseText)&&(__cov_EPeJQXLPxq_qER$ceGa55g.b['10'][1]++,Y.JSON.parse(r.responseText));__cov_EPeJQXLPxq_qER$ceGa55g.s['36']++;Y.Rednose.Notifier.notify({title:TEXT_TITLE_ERROR,text:err.error,type:'error'});}}});},_handleShareConfirm:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['17']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['37']++;var model=e.data.model,self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['38']++;model.save(function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['18']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['39']++;self.popModalView();__cov_EPeJQXLPxq_qER$ceGa55g.s['40']++;self.fire('reload');});},_handleShareRemove:function(e){__cov_EPeJQXLPxq_qER$ceGa55g.f['19']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['41']++;var model=e.data.model,self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['42']++;this.popModalView();__cov_EPeJQXLPxq_qER$ceGa55g.s['43']++;Y.Rednose.Dialog.confirm({title:Y.Lang.sub(TEXT_UNSHARE_TITLE,{item:model.get('item').get('title')}),text:TEXT_UNSHARE_BODY,confirm:TEXT_UNSHARE,type:'warning'},function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['20']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['44']++;model.destroy({remove:true},function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['21']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['45']++;Y.Rednose.Notifier.notify({title:TEXT_TITLE_UNSHARED,text:TEXT_ITEM_UNSHARED,type:'success'});__cov_EPeJQXLPxq_qER$ceGa55g.s['46']++;self.fire('reload');});});},_handleReload:function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['22']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['47']++;var self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['48']++;this.get('item').load(function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['23']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['49']++;self.get('children').reset(self.get('item').get('children'));});},_handleItem:function(req,res,next){__cov_EPeJQXLPxq_qER$ceGa55g.f['24']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['50']++;var path=req.path,item=this.get('item'),self=this;__cov_EPeJQXLPxq_qER$ceGa55g.s['51']++;if((__cov_EPeJQXLPxq_qER$ceGa55g.b['12'][0]++,path===item.get('path'))&&(__cov_EPeJQXLPxq_qER$ceGa55g.b['12'][1]++,!item.isNew())){__cov_EPeJQXLPxq_qER$ceGa55g.b['11'][0]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['52']++;req.item=item;__cov_EPeJQXLPxq_qER$ceGa55g.s['53']++;next();}else{__cov_EPeJQXLPxq_qER$ceGa55g.b['11'][1]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['54']++;item=new Y.Lox.ItemModel({path:path});__cov_EPeJQXLPxq_qER$ceGa55g.s['55']++;item.load(function(){__cov_EPeJQXLPxq_qER$ceGa55g.f['25']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['56']++;self.set('item',item);__cov_EPeJQXLPxq_qER$ceGa55g.s['57']++;req.item=item;__cov_EPeJQXLPxq_qER$ceGa55g.s['58']++;next();});}},_handleChildren:function(req,res,next){__cov_EPeJQXLPxq_qER$ceGa55g.f['26']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['59']++;var item=req.item,children=this.get('children');__cov_EPeJQXLPxq_qER$ceGa55g.s['60']++;req.children=children;__cov_EPeJQXLPxq_qER$ceGa55g.s['61']++;if(item===children.get('item')){__cov_EPeJQXLPxq_qER$ceGa55g.b['13'][0]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['62']++;next();}else{__cov_EPeJQXLPxq_qER$ceGa55g.b['13'][1]++;__cov_EPeJQXLPxq_qER$ceGa55g.s['63']++;children.set('item',item).reset(item.get('children'));__cov_EPeJQXLPxq_qER$ceGa55g.s['64']++;next();}},_showItemPage:function(req){__cov_EPeJQXLPxq_qER$ceGa55g.f['27']++;__cov_EPeJQXLPxq_qER$ceGa55g.s['65']++;this.showView('itemView',{model:req.item,modelList:req.children});}},{ATTRS:{item:{value:new Y.Lox.ItemModel()},children:{value:new Y.ModelList({model:Y.Lox.ItemModel})},root:{value:YUI.Env.routing.home},routes:{value:[{path:'/*',callbacks:['_handleItem','_handleChildren','_showItemPage']}]}}});__cov_EPeJQXLPxq_qER$ceGa55g.s['66']++;Y.namespace('Lox').App=App;},'@VERSION@',{'requires':['lox-app-item-model','rednose-app','rednose-tooltip']});
