if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/lox-app-file-upload-view/lox-app-file-upload-view.js']) {
   __coverage__['build/lox-app-file-upload-view/lox-app-file-upload-view.js'] = {"path":"build/lox-app-file-upload-view/lox-app-file-upload-view.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0},"b":{"1":[0,0],"2":[0,0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":36},"end":{"line":1,"column":55}}},"2":{"name":"(anonymous_2)","line":123,"loc":{"start":{"line":123,"column":14},"end":{"line":123,"column":26}}},"3":{"name":"(anonymous_3)","line":163,"loc":{"start":{"line":163,"column":13},"end":{"line":163,"column":25}}},"4":{"name":"(anonymous_4)","line":184,"loc":{"start":{"line":184,"column":9},"end":{"line":184,"column":21}}},"5":{"name":"(anonymous_5)","line":189,"loc":{"start":{"line":189,"column":16},"end":{"line":189,"column":29}}},"6":{"name":"(anonymous_6)","line":206,"loc":{"start":{"line":206,"column":35},"end":{"line":206,"column":48}}},"7":{"name":"(anonymous_7)","line":214,"loc":{"start":{"line":214,"column":35},"end":{"line":214,"column":48}}},"8":{"name":"(anonymous_8)","line":222,"loc":{"start":{"line":222,"column":35},"end":{"line":222,"column":48}}},"9":{"name":"(anonymous_9)","line":230,"loc":{"start":{"line":230,"column":35},"end":{"line":230,"column":48}}},"10":{"name":"(anonymous_10)","line":267,"loc":{"start":{"line":267,"column":22},"end":{"line":267,"column":34}}},"11":{"name":"(anonymous_11)","line":295,"loc":{"start":{"line":295,"column":18},"end":{"line":295,"column":30}}},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":19},"end":{"line":315,"column":31}}},"13":{"name":"(anonymous_13)","line":321,"loc":{"start":{"line":321,"column":35},"end":{"line":321,"column":51}}},"14":{"name":"(anonymous_14)","line":346,"loc":{"start":{"line":346,"column":17},"end":{"line":346,"column":29}}},"15":{"name":"(anonymous_15)","line":359,"loc":{"start":{"line":359,"column":20},"end":{"line":359,"column":33}}},"16":{"name":"(anonymous_16)","line":374,"loc":{"start":{"line":374,"column":20},"end":{"line":374,"column":33}}},"17":{"name":"(anonymous_17)","line":389,"loc":{"start":{"line":389,"column":25},"end":{"line":389,"column":38}}},"18":{"name":"(anonymous_18)","line":401,"loc":{"start":{"line":401,"column":24},"end":{"line":401,"column":36}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":421,"column":80}},"2":{"start":{"line":11,"column":0},"end":{"line":43,"column":28}},"3":{"start":{"line":56,"column":0},"end":{"line":415,"column":3}},"4":{"start":{"line":124,"column":2},"end":{"line":124,"column":58}},"5":{"start":{"line":126,"column":8},"end":{"line":126,"column":46}},"6":{"start":{"line":128,"column":8},"end":{"line":135,"column":12}},"7":{"start":{"line":137,"column":8},"end":{"line":137,"column":72}},"8":{"start":{"line":138,"column":8},"end":{"line":138,"column":33}},"9":{"start":{"line":140,"column":8},"end":{"line":140,"column":39}},"10":{"start":{"line":142,"column":2},"end":{"line":142,"column":29}},"11":{"start":{"line":144,"column":2},"end":{"line":156,"column":4}},"12":{"start":{"line":164,"column":2},"end":{"line":164,"column":55}},"13":{"start":{"line":166,"column":2},"end":{"line":166,"column":27}},"14":{"start":{"line":167,"column":8},"end":{"line":167,"column":36}},"15":{"start":{"line":168,"column":8},"end":{"line":168,"column":29}},"16":{"start":{"line":170,"column":2},"end":{"line":170,"column":32}},"17":{"start":{"line":171,"column":8},"end":{"line":171,"column":38}},"18":{"start":{"line":172,"column":8},"end":{"line":172,"column":38}},"19":{"start":{"line":173,"column":2},"end":{"line":173,"column":32}},"20":{"start":{"line":185,"column":8},"end":{"line":252,"column":11}},"21":{"start":{"line":190,"column":24},"end":{"line":190,"column":37}},"22":{"start":{"line":192,"column":24},"end":{"line":202,"column":25}},"23":{"start":{"line":194,"column":32},"end":{"line":194,"column":65}},"24":{"start":{"line":195,"column":32},"end":{"line":195,"column":38}},"25":{"start":{"line":197,"column":32},"end":{"line":197,"column":65}},"26":{"start":{"line":198,"column":32},"end":{"line":198,"column":38}},"27":{"start":{"line":200,"column":32},"end":{"line":200,"column":63}},"28":{"start":{"line":201,"column":32},"end":{"line":201,"column":38}},"29":{"start":{"line":204,"column":6},"end":{"line":204,"column":28}},"30":{"start":{"line":207,"column":24},"end":{"line":209,"column":26}},"31":{"start":{"line":215,"column":24},"end":{"line":217,"column":26}},"32":{"start":{"line":223,"column":24},"end":{"line":225,"column":26}},"33":{"start":{"line":231,"column":6},"end":{"line":231,"column":15}},"34":{"start":{"line":233,"column":24},"end":{"line":243,"column":25}},"35":{"start":{"line":235,"column":32},"end":{"line":235,"column":56}},"36":{"start":{"line":236,"column":32},"end":{"line":236,"column":38}},"37":{"start":{"line":238,"column":32},"end":{"line":238,"column":57}},"38":{"start":{"line":239,"column":32},"end":{"line":239,"column":38}},"39":{"start":{"line":241,"column":32},"end":{"line":241,"column":55}},"40":{"start":{"line":242,"column":32},"end":{"line":242,"column":38}},"41":{"start":{"line":245,"column":24},"end":{"line":247,"column":26}},"42":{"start":{"line":254,"column":8},"end":{"line":254,"column":73}},"43":{"start":{"line":256,"column":2},"end":{"line":256,"column":14}},"44":{"start":{"line":268,"column":2},"end":{"line":286,"column":3}},"45":{"start":{"line":269,"column":3},"end":{"line":269,"column":31}},"46":{"start":{"line":271,"column":3},"end":{"line":274,"column":6}},"47":{"start":{"line":276,"column":3},"end":{"line":285,"column":6}},"48":{"start":{"line":296,"column":2},"end":{"line":304,"column":3}},"49":{"start":{"line":297,"column":3},"end":{"line":297,"column":41}},"50":{"start":{"line":299,"column":3},"end":{"line":301,"column":5}},"51":{"start":{"line":303,"column":3},"end":{"line":303,"column":76}},"52":{"start":{"line":316,"column":8},"end":{"line":317,"column":28}},"53":{"start":{"line":319,"column":2},"end":{"line":337,"column":3}},"54":{"start":{"line":321,"column":12},"end":{"line":331,"column":15}},"55":{"start":{"line":322,"column":16},"end":{"line":330,"column":18}},"56":{"start":{"line":333,"column":12},"end":{"line":333,"column":66}},"57":{"start":{"line":335,"column":12},"end":{"line":335,"column":41}},"58":{"start":{"line":336,"column":12},"end":{"line":336,"column":39}},"59":{"start":{"line":347,"column":2},"end":{"line":347,"column":39}},"60":{"start":{"line":349,"column":8},"end":{"line":349,"column":33}},"61":{"start":{"line":350,"column":8},"end":{"line":350,"column":79}},"62":{"start":{"line":360,"column":8},"end":{"line":361,"column":42}},"63":{"start":{"line":363,"column":8},"end":{"line":365,"column":9}},"64":{"start":{"line":364,"column":12},"end":{"line":364,"column":44}},"65":{"start":{"line":375,"column":2},"end":{"line":376,"column":42}},"66":{"start":{"line":378,"column":8},"end":{"line":380,"column":9}},"67":{"start":{"line":379,"column":12},"end":{"line":379,"column":46}},"68":{"start":{"line":390,"column":2},"end":{"line":390,"column":33}},"69":{"start":{"line":392,"column":8},"end":{"line":392,"column":97}},"70":{"start":{"line":402,"column":2},"end":{"line":402,"column":38}},"71":{"start":{"line":403,"column":2},"end":{"line":403,"column":37}},"72":{"start":{"line":405,"column":8},"end":{"line":405,"column":33}},"73":{"start":{"line":407,"column":2},"end":{"line":407,"column":33}},"74":{"start":{"line":418,"column":0},"end":{"line":418,"column":55}}},"branchMap":{"1":{"line":124,"type":"binary-expr","locations":[{"start":{"line":124,"column":2},"end":{"line":124,"column":24}},{"start":{"line":124,"column":29},"end":{"line":124,"column":56}}]},"2":{"line":192,"type":"switch","locations":[{"start":{"line":193,"column":28},"end":{"line":195,"column":38}},{"start":{"line":196,"column":28},"end":{"line":198,"column":38}},{"start":{"line":199,"column":28},"end":{"line":201,"column":38}}]},"3":{"line":233,"type":"switch","locations":[{"start":{"line":234,"column":28},"end":{"line":236,"column":38}},{"start":{"line":237,"column":28},"end":{"line":239,"column":38}},{"start":{"line":240,"column":28},"end":{"line":242,"column":38}}]},"4":{"line":268,"type":"if","locations":[{"start":{"line":268,"column":2},"end":{"line":268,"column":2}},{"start":{"line":268,"column":2},"end":{"line":268,"column":2}}]},"5":{"line":268,"type":"binary-expr","locations":[{"start":{"line":268,"column":6},"end":{"line":268,"column":32}},{"start":{"line":268,"column":36},"end":{"line":268,"column":45}}]},"6":{"line":296,"type":"if","locations":[{"start":{"line":296,"column":2},"end":{"line":296,"column":2}},{"start":{"line":296,"column":2},"end":{"line":296,"column":2}}]},"7":{"line":319,"type":"if","locations":[{"start":{"line":319,"column":2},"end":{"line":319,"column":2}},{"start":{"line":319,"column":2},"end":{"line":319,"column":2}}]},"8":{"line":363,"type":"if","locations":[{"start":{"line":363,"column":8},"end":{"line":363,"column":8}},{"start":{"line":363,"column":8},"end":{"line":363,"column":8}}]},"9":{"line":378,"type":"if","locations":[{"start":{"line":378,"column":8},"end":{"line":378,"column":8}},{"start":{"line":378,"column":8},"end":{"line":378,"column":8}}]}},"code":["(function () { YUI.add('lox-app-file-upload-view', function (Y, NAME) {","","/*jshint expr:true, onevar:false */","","/**","Provides a view to upload multiple files.","","@module lox-app","@submodule lox-app-file-upload-view","**/","var TEXT_CHOOSE_FILES    = 'Choose files',","\tTEXT_CANCEL          = 'Close',","\tTEXT_UPLOAD_FILES    = 'Upload files...',","\tTEXT_UPLOAD_BODY     = 'Upload files to LocalBox.',","\tTEXT_UPLOAD_SUB_BODY = 'You can upload more then one file at a time.',","","    UPLOAD_URL = YUI.Env.routing.upload,","","\tSTYLE_UPLOADER_BUTTON_WIDTH = 104,","\tSTYLE_UPLOAD_BUTTON_HEIGHT  = 30,","","    CSS_FILE_LIST = 'file-list',","    CSS_BODY_TEXT = 'body-text',","","\tCSS_BOOTSTRAP_BTN         = 'btn',","\tCSS_BOOTSTRAP_BTN_PRIMARY = 'btn-primary',","\tCSS_BOOTSTRAP_FLOAT_RIGHT = 'float-right',","\tCSS_BOOTSTRAP_DISABLED    = 'disabled',","\tCSS_BOOTSTRAP_PROGRESS    = 'progress',","\tCSS_BOOTSTRAP_BAR         = 'bar',","\tCSS_BOOTSTRAP_SUCCESS     = 'success',","\tCSS_BOOTSTRAP_WARNING     = 'warning',","    CSS_BOOTSTRAP_ERROR       = 'error',","","    EVT_UPLOAD_COMPLETE = 'uploadcomplete',","","    STATE_PENDING  = 'pending',","    STATE_FAILED   = 'failed',","    STATE_FINISHED = 'finished',","","    CSS_ICON_PENDING  = '✘',","    CSS_ICON_FAILED   = '✘',","    CSS_ICON_FINISHED = '✔';","","/**","Provides a view to upload multiple files.","","@class FileUploadView","@param {Object} [config] Config properties.","\t@param {Object} [config.container] The container the view will be rendered in.","@namespace Lox.App","@constructor","@extends View","@uses Rednose.View.Nav","**/","var FileUploadView = Y.Base.create('fileUploadView', Y.View, [ Y.Rednose.View.Nav ], {","\t// -- Pubic properties -----------------------------------------------------","","    /**","    Uploader button template.","","    @property UPLOADER_TEMPLATE","    @type {String}","    @public","    **/","    UPLOADER_TEMPLATE: '<button class=\"{buttonClass}\">{buttonText}</button>',","","\t/**","\tTitle of this dialog.","","\t@property {String} title","\t**/","\ttitle: TEXT_UPLOAD_FILES,","","    close: true,","","\t/**","\tContainer template.","","\t@property {String} template","    @public","\t**/","\ttemplate: '<div>' +","                  '<div class=\"{classBody}\"><p>{textBody}</p><p>{textSubBody}</p></div>' +","                  '<p><div class=\"{classFileList}\"></div></p>' +","                  '<p><div class=\"{classProgress}\"><div class=\"{classBar}\" style=\"width: 0%;\"></div></div></p>' +","              '</div>',","","\t/**","\tPredefined buttons.","","\t@property {Object} buttons","\t**/","\tbuttons: {","\t\tcancel: {","\t\t\tvalue: TEXT_CANCEL,","\t\t\tposition: 'right'","\t\t}","\t},","","\t// -- Protected properties -------------------------------------------------","","\t/**","\tUploader instance.","","\t@property {Uploader} _uploader","\t**/","\t_uploader: null,","","    /**","    Progressbar node.","","    @property {Node} _progressBar","    **/","    _progressBar: null,","","\t// -- Lifecycle Methods ----------------------------------------------------","","\t/**","\t@method initializer","\t@protected","\t**/","\tinitializer: function () {","\t\tthis._dialogViewEvents || (this._dialogViewEvents = []);","","        var container = this.get('container');","","        container.setContent(Y.Lang.sub(this.template, {","            classBody    : CSS_BODY_TEXT,","            textBody     : TEXT_UPLOAD_BODY,","            textSubBody  : TEXT_UPLOAD_SUB_BODY,","\t\t\tclassFileList: CSS_FILE_LIST,","\t\t\tclassProgress: CSS_BOOTSTRAP_PROGRESS,","\t\t\tclassBar     : CSS_BOOTSTRAP_BAR","        }));","","        this._progressBar = container.one('.' + CSS_BOOTSTRAP_PROGRESS);","        this._progressBar.hide();","","        this.items = new Y.ModelList();","","\t\tthis._initializeUploader();","","\t\tthis._dialogViewEvents.push(","\t\t\t// Bind on the Y.Rednose.View.Nav render event handler.","\t\t\tY.Do.after(this._renderUploader, this, '_afterRender', this),","","\t\t\t// Uploader events","\t\t\tthis._uploader.after('fileselect', this._afterFileSelect, this),","","\t\t\tthis._uploader.on('uploadstart', this._onUploadStart, this),","\t\t\tthis._uploader.on('uploadcomplete', this._onUploadComplete, this),","            this._uploader.on('uploaderror', this._onUploadError, this),","\t\t\tthis._uploader.on('totaluploadprogress', this._onTotalUploadProgress, this),","\t\t\tthis._uploader.on('alluploadscomplete', this._onAllUploadsComplete, this)","\t\t);","\t},","","\t/**","\t@method initializer","\t@protected","\t**/","\tdestructor: function () {","\t\t(new Y.EventHandle(this._dialogViewEvents)).detach();","","\t\tthis._uploader.destroy();","        this._progressBar.destroy();","        this.items.destroy();","","\t\tthis._uploader         = null;","        this._progressBar      = null;","        this.items             = null;","\t\tthis.UPLOADER_TEMPLATE = null;","\t},","","\t// -- Public Methods -------------------------------------------------------","","\t/**","\tRenders this DialogView into its container, encapsulated in a modal panel.","","\t@method render","\t@chainable","\t**/","\trender: function () {","        var dataTable = new Y.Rednose.DataTable({","\t\t\tcolumns: [","                {","                    key: 'name',","\t\t\t\t\tformatter: function (o) {","                        var rowClass;","","                        switch (o.data.state) {","                            case STATE_PENDING:","                                rowClass = CSS_BOOTSTRAP_WARNING;","                                break;","                            case STATE_FINISHED:","                                rowClass = CSS_BOOTSTRAP_SUCCESS;","                                break;","                            default:","                                rowClass = CSS_BOOTSTRAP_ERROR;","                                break;","                        }","","\t\t\t\t\t\to.rowClass = rowClass;","\t\t\t\t\t},","                    nodeFormatter: function (o) {","                        o.cell.set('innerHTML',","                            '<div style=\"width: 319px;\">' + o.data.name + '</div>'","                        );","                    }","                },","                {","                    key: 'type',","                    nodeFormatter: function (o) {","                        o.cell.set('innerHTML',","                            '<div style=\"width: 120px;\">' + o.data.type + '</div>'","                        );","                    }","                },","                {","                    key: 'size',","                    nodeFormatter: function (o) {","                        o.cell.set('innerHTML',","                            '<div style=\"width: 80px;\">' + Y.Rednose.Formatter.size(o.data.size) + '</div>'","                        );","                    }","                },","                {","                    key: 'icon',","                    nodeFormatter: function (o) {","\t\t\t\t\t\tvar icon;","","                        switch (o.data.state) {","                            case STATE_PENDING:","                                icon = CSS_ICON_PENDING;","                                break;","                            case STATE_FINISHED:","                                icon = CSS_ICON_FINISHED;","                                break;","                            default:","                                icon = CSS_ICON_FAILED;","                                break;","                        }","","                        o.cell.set('innerHTML',","                            '<div style=\"width: 25px;\">' + icon + '</div>'","                        );","                    }","                }","            ],","            data: this.items","        });","","        dataTable.render(this.get('container').one('.' + CSS_FILE_LIST));","","\t\treturn this;","\t},","","    // -- Protected Methods -----------------------------------------------------","","\t/**","\tInitializes the uploader.","","\t@method _initializeUploader","\t@protected","\t**/","\t_initializeUploader: function () {","\t\tif (Y.Uploader.TYPE !== 'none' && !Y.UA.ios) {","\t\t\tvar path = this.get('path');","","\t\t\tY.Uploader.SELECT_FILES_BUTTON = Y.Lang.sub(this.UPLOADER_TEMPLATE, {","\t\t\t\tbuttonClass: CSS_BOOTSTRAP_BTN + ' ' + CSS_BOOTSTRAP_BTN_PRIMARY + ' ' + CSS_BOOTSTRAP_FLOAT_RIGHT,","\t\t\t\tbuttonText : TEXT_CHOOSE_FILES","\t\t\t});","","\t\t\tthis._uploader = new Y.Uploader({","\t\t\t\twidth           : STYLE_UPLOADER_BUTTON_WIDTH,","\t\t\t\theight          : STYLE_UPLOAD_BUTTON_HEIGHT,","\t\t\t\tmultipleFiles   : true,","                uploadURL       : UPLOAD_URL,","\t\t\t\tsimLimit        : 2,","                postVarsPerFile : { token: YUI.Env.token, path: path },","\t\t\t\twithCredentials : false,","\t\t\t\tbuttonClassNames: { disabled: CSS_BOOTSTRAP_DISABLED }","\t\t\t});","\t\t}","\t},","","\t/**","\tRenders the uploader after the Nav View has rendered the footer section.","","\t@method _renderUploader","\t@protected","\t**/","\t_renderUploader: function () {","\t\tif (this._uploader) {","\t\t\tvar container = this.get('container');","","\t\t\tcontainer.one('.yui3-widget-ft div').prepend(","\t\t\t\tY.Node.create('<div id=\"choose-files-button\" class=\"' + CSS_BOOTSTRAP_FLOAT_RIGHT + '\"></div>')","\t\t\t);","","\t\t\tthis._uploader.render(this.get('container').one('#choose-files-button'));","\t\t}","\t},","","    // -- Protected Event Handlers ----------------------------------------------","","\t/**","\tTrigger the upload process after the files have been selected.","","\t@method _afterFileSelect","\t@protected","\t**/","\t_afterFileSelect: function () {","        var fileList   = this._uploader.get('fileList'),","            filesModel = [];","","\t\tif (fileList.length > 0) {","","            Y.Array.each(fileList, function (file) {","                filesModel.push(","                    new Y.Model({","                        id   : file.get('id'),","                        name : file.get('name'),","                        type : file.get('type'),","                        size : file.get('size'),","                        state: STATE_PENDING,","                    })","                );","            });","","            this.get('container').one('.' + CSS_BODY_TEXT).hide();","","            this.items.reset(filesModel);","            this._uploader.uploadAll();","\t\t}","\t},","","\t/**","\tLock the uploader when the upload has started.","","\t@method _onUploadStart","\t@protected","\t**/","\t_onUploadStart: function () {","\t\tthis._uploader.set('enabled', false);","","        this._progressBar.show();","        this._progressBar.one('.' + CSS_BOOTSTRAP_BAR).setStyle('width', '0%');","\t},","","    /**","    Error handler for individual uploads.","","    @method _onUploadError","    @protected","    **/","    _onUploadError: function (e) {","        var id   = e.file.get('id'),","            item = this.items.getById(id);","","        if (item) {","            item.set('state', STATE_FAILED);","        }","    },","","\t/**","\tCompletion handler for individual uploads.","","\t@method _onUploadComplete","\t@protected","\t**/","\t_onUploadComplete: function (e) {","\t\tvar id   = e.file.get('id'),","            item = this.items.getById(id);","","        if (item) {","            item.set('state', STATE_FINISHED);","        }","\t},","","\t/**","\tReport the overall upload progress.","","\t@method _onTotalUploadProgress","\t@protected","\t**/","\t_onTotalUploadProgress: function (e) {","\t\tvar progress = e.percentLoaded;","","        this._progressBar.one('.' + CSS_BOOTSTRAP_BAR).setStyle('width', String(progress) + '%');","\t},","","\t/**","\tCompletion handler, resets the view to enable new file uploads.","","\t@method _onAllUploadsComplete","\t@protected","\t**/","\t_onAllUploadsComplete: function () {","\t\tthis._uploader.set('enabled', true);","\t\tthis._uploader.set('fileList', []);","","        this._progressBar.hide();","","\t\tthis.fire(EVT_UPLOAD_COMPLETE);","\t}","}, {","\tATTRS: {","\t\tpath: {","\t\t\tvalue: '/'","\t\t}","\t}","});","","// -- Namespace ----------------------------------------------------------------","Y.namespace('Lox.App').FileUploadView = FileUploadView;","","","}, '@VERSION@', {\"requires\": [\"rednose-app\", \"rednose-formatter\", \"uploader\"]});","","}());"]};
}
var __cov_NZtoHZE1IrFqRTOSw68ABA = __coverage__['build/lox-app-file-upload-view/lox-app-file-upload-view.js'];
__cov_NZtoHZE1IrFqRTOSw68ABA.s['1']++;YUI.add('lox-app-file-upload-view',function(Y,NAME){__cov_NZtoHZE1IrFqRTOSw68ABA.f['1']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['2']++;var TEXT_CHOOSE_FILES='Choose files',TEXT_CANCEL='Close',TEXT_UPLOAD_FILES='Upload files...',TEXT_UPLOAD_BODY='Upload files to LocalBox.',TEXT_UPLOAD_SUB_BODY='You can upload more then one file at a time.',UPLOAD_URL=YUI.Env.routing.upload,STYLE_UPLOADER_BUTTON_WIDTH=104,STYLE_UPLOAD_BUTTON_HEIGHT=30,CSS_FILE_LIST='file-list',CSS_BODY_TEXT='body-text',CSS_BOOTSTRAP_BTN='btn',CSS_BOOTSTRAP_BTN_PRIMARY='btn-primary',CSS_BOOTSTRAP_FLOAT_RIGHT='float-right',CSS_BOOTSTRAP_DISABLED='disabled',CSS_BOOTSTRAP_PROGRESS='progress',CSS_BOOTSTRAP_BAR='bar',CSS_BOOTSTRAP_SUCCESS='success',CSS_BOOTSTRAP_WARNING='warning',CSS_BOOTSTRAP_ERROR='error',EVT_UPLOAD_COMPLETE='uploadcomplete',STATE_PENDING='pending',STATE_FAILED='failed',STATE_FINISHED='finished',CSS_ICON_PENDING='\u2718',CSS_ICON_FAILED='\u2718',CSS_ICON_FINISHED='\u2714';__cov_NZtoHZE1IrFqRTOSw68ABA.s['3']++;var FileUploadView=Y.Base.create('fileUploadView',Y.View,[Y.Rednose.View.Nav],{UPLOADER_TEMPLATE:'<button class="{buttonClass}">{buttonText}</button>',title:TEXT_UPLOAD_FILES,close:true,template:'<div>'+'<div class="{classBody}"><p>{textBody}</p><p>{textSubBody}</p></div>'+'<p><div class="{classFileList}"></div></p>'+'<p><div class="{classProgress}"><div class="{classBar}" style="width: 0%;"></div></div></p>'+'</div>',buttons:{cancel:{value:TEXT_CANCEL,position:'right'}},_uploader:null,_progressBar:null,initializer:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['2']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['4']++;(__cov_NZtoHZE1IrFqRTOSw68ABA.b['1'][0]++,this._dialogViewEvents)||(__cov_NZtoHZE1IrFqRTOSw68ABA.b['1'][1]++,this._dialogViewEvents=[]);__cov_NZtoHZE1IrFqRTOSw68ABA.s['5']++;var container=this.get('container');__cov_NZtoHZE1IrFqRTOSw68ABA.s['6']++;container.setContent(Y.Lang.sub(this.template,{classBody:CSS_BODY_TEXT,textBody:TEXT_UPLOAD_BODY,textSubBody:TEXT_UPLOAD_SUB_BODY,classFileList:CSS_FILE_LIST,classProgress:CSS_BOOTSTRAP_PROGRESS,classBar:CSS_BOOTSTRAP_BAR}));__cov_NZtoHZE1IrFqRTOSw68ABA.s['7']++;this._progressBar=container.one('.'+CSS_BOOTSTRAP_PROGRESS);__cov_NZtoHZE1IrFqRTOSw68ABA.s['8']++;this._progressBar.hide();__cov_NZtoHZE1IrFqRTOSw68ABA.s['9']++;this.items=new Y.ModelList();__cov_NZtoHZE1IrFqRTOSw68ABA.s['10']++;this._initializeUploader();__cov_NZtoHZE1IrFqRTOSw68ABA.s['11']++;this._dialogViewEvents.push(Y.Do.after(this._renderUploader,this,'_afterRender',this),this._uploader.after('fileselect',this._afterFileSelect,this),this._uploader.on('uploadstart',this._onUploadStart,this),this._uploader.on('uploadcomplete',this._onUploadComplete,this),this._uploader.on('uploaderror',this._onUploadError,this),this._uploader.on('totaluploadprogress',this._onTotalUploadProgress,this),this._uploader.on('alluploadscomplete',this._onAllUploadsComplete,this));},destructor:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['3']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['12']++;new Y.EventHandle(this._dialogViewEvents).detach();__cov_NZtoHZE1IrFqRTOSw68ABA.s['13']++;this._uploader.destroy();__cov_NZtoHZE1IrFqRTOSw68ABA.s['14']++;this._progressBar.destroy();__cov_NZtoHZE1IrFqRTOSw68ABA.s['15']++;this.items.destroy();__cov_NZtoHZE1IrFqRTOSw68ABA.s['16']++;this._uploader=null;__cov_NZtoHZE1IrFqRTOSw68ABA.s['17']++;this._progressBar=null;__cov_NZtoHZE1IrFqRTOSw68ABA.s['18']++;this.items=null;__cov_NZtoHZE1IrFqRTOSw68ABA.s['19']++;this.UPLOADER_TEMPLATE=null;},render:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['4']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['20']++;var dataTable=new Y.Rednose.DataTable({columns:[{key:'name',formatter:function(o){__cov_NZtoHZE1IrFqRTOSw68ABA.f['5']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['21']++;var rowClass;__cov_NZtoHZE1IrFqRTOSw68ABA.s['22']++;switch(o.data.state){case STATE_PENDING:__cov_NZtoHZE1IrFqRTOSw68ABA.b['2'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['23']++;rowClass=CSS_BOOTSTRAP_WARNING;__cov_NZtoHZE1IrFqRTOSw68ABA.s['24']++;break;case STATE_FINISHED:__cov_NZtoHZE1IrFqRTOSw68ABA.b['2'][1]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['25']++;rowClass=CSS_BOOTSTRAP_SUCCESS;__cov_NZtoHZE1IrFqRTOSw68ABA.s['26']++;break;default:__cov_NZtoHZE1IrFqRTOSw68ABA.b['2'][2]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['27']++;rowClass=CSS_BOOTSTRAP_ERROR;__cov_NZtoHZE1IrFqRTOSw68ABA.s['28']++;break;}__cov_NZtoHZE1IrFqRTOSw68ABA.s['29']++;o.rowClass=rowClass;},nodeFormatter:function(o){__cov_NZtoHZE1IrFqRTOSw68ABA.f['6']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['30']++;o.cell.set('innerHTML','<div style="width: 319px;">'+o.data.name+'</div>');}},{key:'type',nodeFormatter:function(o){__cov_NZtoHZE1IrFqRTOSw68ABA.f['7']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['31']++;o.cell.set('innerHTML','<div style="width: 120px;">'+o.data.type+'</div>');}},{key:'size',nodeFormatter:function(o){__cov_NZtoHZE1IrFqRTOSw68ABA.f['8']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['32']++;o.cell.set('innerHTML','<div style="width: 80px;">'+Y.Rednose.Formatter.size(o.data.size)+'</div>');}},{key:'icon',nodeFormatter:function(o){__cov_NZtoHZE1IrFqRTOSw68ABA.f['9']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['33']++;var icon;__cov_NZtoHZE1IrFqRTOSw68ABA.s['34']++;switch(o.data.state){case STATE_PENDING:__cov_NZtoHZE1IrFqRTOSw68ABA.b['3'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['35']++;icon=CSS_ICON_PENDING;__cov_NZtoHZE1IrFqRTOSw68ABA.s['36']++;break;case STATE_FINISHED:__cov_NZtoHZE1IrFqRTOSw68ABA.b['3'][1]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['37']++;icon=CSS_ICON_FINISHED;__cov_NZtoHZE1IrFqRTOSw68ABA.s['38']++;break;default:__cov_NZtoHZE1IrFqRTOSw68ABA.b['3'][2]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['39']++;icon=CSS_ICON_FAILED;__cov_NZtoHZE1IrFqRTOSw68ABA.s['40']++;break;}__cov_NZtoHZE1IrFqRTOSw68ABA.s['41']++;o.cell.set('innerHTML','<div style="width: 25px;">'+icon+'</div>');}}],data:this.items});__cov_NZtoHZE1IrFqRTOSw68ABA.s['42']++;dataTable.render(this.get('container').one('.'+CSS_FILE_LIST));__cov_NZtoHZE1IrFqRTOSw68ABA.s['43']++;return this;},_initializeUploader:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['10']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['44']++;if((__cov_NZtoHZE1IrFqRTOSw68ABA.b['5'][0]++,Y.Uploader.TYPE!=='none')&&(__cov_NZtoHZE1IrFqRTOSw68ABA.b['5'][1]++,!Y.UA.ios)){__cov_NZtoHZE1IrFqRTOSw68ABA.b['4'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['45']++;var path=this.get('path');__cov_NZtoHZE1IrFqRTOSw68ABA.s['46']++;Y.Uploader.SELECT_FILES_BUTTON=Y.Lang.sub(this.UPLOADER_TEMPLATE,{buttonClass:CSS_BOOTSTRAP_BTN+' '+CSS_BOOTSTRAP_BTN_PRIMARY+' '+CSS_BOOTSTRAP_FLOAT_RIGHT,buttonText:TEXT_CHOOSE_FILES});__cov_NZtoHZE1IrFqRTOSw68ABA.s['47']++;this._uploader=new Y.Uploader({width:STYLE_UPLOADER_BUTTON_WIDTH,height:STYLE_UPLOAD_BUTTON_HEIGHT,multipleFiles:true,uploadURL:UPLOAD_URL,simLimit:2,postVarsPerFile:{token:YUI.Env.token,path:path},withCredentials:false,buttonClassNames:{disabled:CSS_BOOTSTRAP_DISABLED}});}else{__cov_NZtoHZE1IrFqRTOSw68ABA.b['4'][1]++;}},_renderUploader:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['11']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['48']++;if(this._uploader){__cov_NZtoHZE1IrFqRTOSw68ABA.b['6'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['49']++;var container=this.get('container');__cov_NZtoHZE1IrFqRTOSw68ABA.s['50']++;container.one('.yui3-widget-ft div').prepend(Y.Node.create('<div id="choose-files-button" class="'+CSS_BOOTSTRAP_FLOAT_RIGHT+'"></div>'));__cov_NZtoHZE1IrFqRTOSw68ABA.s['51']++;this._uploader.render(this.get('container').one('#choose-files-button'));}else{__cov_NZtoHZE1IrFqRTOSw68ABA.b['6'][1]++;}},_afterFileSelect:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['12']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['52']++;var fileList=this._uploader.get('fileList'),filesModel=[];__cov_NZtoHZE1IrFqRTOSw68ABA.s['53']++;if(fileList.length>0){__cov_NZtoHZE1IrFqRTOSw68ABA.b['7'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['54']++;Y.Array.each(fileList,function(file){__cov_NZtoHZE1IrFqRTOSw68ABA.f['13']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['55']++;filesModel.push(new Y.Model({id:file.get('id'),name:file.get('name'),type:file.get('type'),size:file.get('size'),state:STATE_PENDING}));});__cov_NZtoHZE1IrFqRTOSw68ABA.s['56']++;this.get('container').one('.'+CSS_BODY_TEXT).hide();__cov_NZtoHZE1IrFqRTOSw68ABA.s['57']++;this.items.reset(filesModel);__cov_NZtoHZE1IrFqRTOSw68ABA.s['58']++;this._uploader.uploadAll();}else{__cov_NZtoHZE1IrFqRTOSw68ABA.b['7'][1]++;}},_onUploadStart:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['14']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['59']++;this._uploader.set('enabled',false);__cov_NZtoHZE1IrFqRTOSw68ABA.s['60']++;this._progressBar.show();__cov_NZtoHZE1IrFqRTOSw68ABA.s['61']++;this._progressBar.one('.'+CSS_BOOTSTRAP_BAR).setStyle('width','0%');},_onUploadError:function(e){__cov_NZtoHZE1IrFqRTOSw68ABA.f['15']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['62']++;var id=e.file.get('id'),item=this.items.getById(id);__cov_NZtoHZE1IrFqRTOSw68ABA.s['63']++;if(item){__cov_NZtoHZE1IrFqRTOSw68ABA.b['8'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['64']++;item.set('state',STATE_FAILED);}else{__cov_NZtoHZE1IrFqRTOSw68ABA.b['8'][1]++;}},_onUploadComplete:function(e){__cov_NZtoHZE1IrFqRTOSw68ABA.f['16']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['65']++;var id=e.file.get('id'),item=this.items.getById(id);__cov_NZtoHZE1IrFqRTOSw68ABA.s['66']++;if(item){__cov_NZtoHZE1IrFqRTOSw68ABA.b['9'][0]++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['67']++;item.set('state',STATE_FINISHED);}else{__cov_NZtoHZE1IrFqRTOSw68ABA.b['9'][1]++;}},_onTotalUploadProgress:function(e){__cov_NZtoHZE1IrFqRTOSw68ABA.f['17']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['68']++;var progress=e.percentLoaded;__cov_NZtoHZE1IrFqRTOSw68ABA.s['69']++;this._progressBar.one('.'+CSS_BOOTSTRAP_BAR).setStyle('width',String(progress)+'%');},_onAllUploadsComplete:function(){__cov_NZtoHZE1IrFqRTOSw68ABA.f['18']++;__cov_NZtoHZE1IrFqRTOSw68ABA.s['70']++;this._uploader.set('enabled',true);__cov_NZtoHZE1IrFqRTOSw68ABA.s['71']++;this._uploader.set('fileList',[]);__cov_NZtoHZE1IrFqRTOSw68ABA.s['72']++;this._progressBar.hide();__cov_NZtoHZE1IrFqRTOSw68ABA.s['73']++;this.fire(EVT_UPLOAD_COMPLETE);}},{ATTRS:{path:{value:'/'}}});__cov_NZtoHZE1IrFqRTOSw68ABA.s['74']++;Y.namespace('Lox.App').FileUploadView=FileUploadView;},'@VERSION@',{'requires':['rednose-app','rednose-formatter','uploader']});
