if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/lox-page/lox-page.js']) {
   __coverage__['build/lox-page/lox-page.js'] = {"path":"build/lox-page/lox-page.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":20},"end":{"line":1,"column":39}}},"2":{"name":"(anonymous_2)","line":27,"loc":{"start":{"line":27,"column":17},"end":{"line":27,"column":29}}},"3":{"name":"(anonymous_3)","line":52,"loc":{"start":{"line":52,"column":16},"end":{"line":52,"column":28}}},"4":{"name":"(anonymous_4)","line":60,"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":24}}},"5":{"name":"(anonymous_5)","line":68,"loc":{"start":{"line":68,"column":16},"end":{"line":68,"column":28}}},"6":{"name":"(anonymous_6)","line":77,"loc":{"start":{"line":77,"column":25},"end":{"line":77,"column":38}}},"7":{"name":"(anonymous_7)","line":88,"loc":{"start":{"line":88,"column":26},"end":{"line":88,"column":38}}},"8":{"name":"(anonymous_8)","line":94,"loc":{"start":{"line":94,"column":26},"end":{"line":94,"column":43}}},"9":{"name":"(anonymous_9)","line":101,"loc":{"start":{"line":101,"column":39},"end":{"line":101,"column":55}}},"10":{"name":"(anonymous_10)","line":111,"loc":{"start":{"line":111,"column":19},"end":{"line":111,"column":31}}},"11":{"name":"(anonymous_11)","line":115,"loc":{"start":{"line":115,"column":29},"end":{"line":115,"column":41}}},"12":{"name":"(anonymous_12)","line":119,"loc":{"start":{"line":119,"column":30},"end":{"line":119,"column":42}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":147,"column":3}},"2":{"start":{"line":10,"column":0},"end":{"line":11,"column":43}},"3":{"start":{"line":13,"column":0},"end":{"line":13,"column":32}},"4":{"start":{"line":23,"column":0},"end":{"line":129,"column":3}},"5":{"start":{"line":28,"column":8},"end":{"line":28,"column":47}},"6":{"start":{"line":30,"column":8},"end":{"line":30,"column":45}},"7":{"start":{"line":32,"column":8},"end":{"line":36,"column":11}},"8":{"start":{"line":38,"column":8},"end":{"line":44,"column":9}},"9":{"start":{"line":39,"column":12},"end":{"line":43,"column":15}},"10":{"start":{"line":46,"column":8},"end":{"line":46,"column":26}},"11":{"start":{"line":48,"column":8},"end":{"line":48,"column":36}},"12":{"start":{"line":49,"column":8},"end":{"line":49,"column":29}},"13":{"start":{"line":53,"column":8},"end":{"line":53,"column":30}},"14":{"start":{"line":55,"column":8},"end":{"line":55,"column":27}},"15":{"start":{"line":61,"column":8},"end":{"line":61,"column":29}},"16":{"start":{"line":63,"column":8},"end":{"line":63,"column":20}},"17":{"start":{"line":69,"column":8},"end":{"line":69,"column":24}},"18":{"start":{"line":71,"column":8},"end":{"line":73,"column":11}},"19":{"start":{"line":75,"column":8},"end":{"line":83,"column":10}},"20":{"start":{"line":78,"column":20},"end":{"line":78,"column":81}},"21":{"start":{"line":80,"column":20},"end":{"line":80,"column":87}},"22":{"start":{"line":85,"column":8},"end":{"line":85,"column":63}},"23":{"start":{"line":89,"column":8},"end":{"line":89,"column":24}},"24":{"start":{"line":91,"column":8},"end":{"line":108,"column":11}},"25":{"start":{"line":95,"column":20},"end":{"line":97,"column":38}},"26":{"start":{"line":99,"column":20},"end":{"line":99,"column":59}},"27":{"start":{"line":101,"column":20},"end":{"line":103,"column":23}},"28":{"start":{"line":102,"column":24},"end":{"line":102,"column":72}},"29":{"start":{"line":105,"column":20},"end":{"line":105,"column":65}},"30":{"start":{"line":112,"column":8},"end":{"line":113,"column":28}},"31":{"start":{"line":115,"column":8},"end":{"line":127,"column":11}},"32":{"start":{"line":116,"column":12},"end":{"line":126,"column":15}},"33":{"start":{"line":120,"column":24},"end":{"line":120,"column":52}},"34":{"start":{"line":123,"column":24},"end":{"line":123,"column":71}},"35":{"start":{"line":132,"column":0},"end":{"line":132,"column":31}}},"branchMap":{"1":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":38,"column":8}},{"start":{"line":38,"column":8},"end":{"line":38,"column":8}}]},"2":{"line":80,"type":"cond-expr","locations":[{"start":{"line":80,"column":73},"end":{"line":80,"column":78}},{"start":{"line":80,"column":81},"end":{"line":80,"column":85}}]}},"code":["(function () { YUI.add('lox-page', function (Y, NAME) {","","/*jshint boss:true, expr:true, onevar:false */","","/**","Base page.","","@module lox-page","**/","var TEXT_MENU_CHANGE_PASSWORD = 'Change password',","    TEXT_MENU_SIGN_OUT        = 'Sign out';","","var SHORT_POLLING_INTERVAL = 10;","","/**","Base page.","","@class Page","@namespace Lox","@constructor","@extends View","**/","var Page = Y.Base.create('page', Y.View, [], {","","    // -- Lifecycle methods ----------------------------------------------------","","    initializer: function () {","        var dropdown = Y.one('#user-dropdown');","","        this.navBar = new Y.Rednose.Navbar();","","        this.navBar.createDropdown(dropdown, [","            { title: TEXT_MENU_CHANGE_PASSWORD, url: YUI.Env.routing.change_password },","            { title: '-' },","            { title: TEXT_MENU_SIGN_OUT, url: YUI.Env.routing.logout }","        ]);","","        if (Y.one('.libbit-lox-sidenav')) {","            Y.one('.libbit-lox-sidenav').plug(Y.Plugin.Affix, {","                offset: {","                    top: 70","                }","            });","        }","","        this._initBadge();","","        this._updateNotifications();","        this._bindMarkRead();","    },","","    destructor: function () {","        this.navBar.destroy();","","        this.navBar = null;","    },","","    // -- Public methods -------------------------------------------------------","","    render: function () {","        this.navBar.render();","","        return this;","    },","","    // -- Protected methods ----------------------------------------------------","","    _initBadge: function () {","        var request, ds;","","        ds = new Y.DataSource.IO({","            source: YUI.Env.routing.notifications_unread","        });","","        request = {","            callback: {","                success: function (e) {","                    var count = parseInt(e.response.results[0].responseText, 10);","","                    Y.one('#badge-notifications').setContent(count > 0 ? count : null);","                }","            }","        };","","        ds.setInterval(SHORT_POLLING_INTERVAL * 6000, request);","    },","","    _updateNotifications: function () {","        var self = this;","","        Y.io(YUI.Env.routing.notifications, {","            method: 'GET',","            on : {","                success : function (tx, r) {","                    var dropdown = Y.one('#notifications-dropdown'),","                        data     = Y.JSON.parse(r.responseText),","                        config   = [];","","                    dropdown.one('.dropdown-menu').empty();","","                    Y.Array.each(data, function (item) {","                        config.push({ node: Y.Node.create(item.html) });","                    });","","                    self.navBar.createDropdown(dropdown, config);","                }","            }","        });","    },","","    _bindMarkRead: function () {","        var dropdown = Y.one('#notifications-dropdown'),","            self     = this;","","        dropdown.on('click', function () {","            Y.io(YUI.Env.routing.notifications_mark_read, {","                method: 'POST',","                on : {","                    success : function () {","                        self._updateNotifications();","","                        // Reset the badge.","                        Y.one('#badge-notifications').setContent(null);","                    }","                }","            });","        });","    }","});","","// -- Namespace ----------------------------------------------------------------","Y.namespace('Lox').Page = Page;","","","}, '@VERSION@', {","    \"requires\": [","        \"node\",","        \"base\",","        \"datasource-io\",","        \"datasource-polling\",","        \"gallery-affix\",","        \"io\",","        \"json\",","        \"rednose-navbar\",","        \"view\"","    ]","});","","}());"]};
}
var __cov_Qf2kPdig9IEIe_IE9vuLSw = __coverage__['build/lox-page/lox-page.js'];
__cov_Qf2kPdig9IEIe_IE9vuLSw.s['1']++;YUI.add('lox-page',function(Y,NAME){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['1']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['2']++;var TEXT_MENU_CHANGE_PASSWORD='Change password',TEXT_MENU_SIGN_OUT='Sign out';__cov_Qf2kPdig9IEIe_IE9vuLSw.s['3']++;var SHORT_POLLING_INTERVAL=10;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['4']++;var Page=Y.Base.create('page',Y.View,[],{initializer:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['2']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['5']++;var dropdown=Y.one('#user-dropdown');__cov_Qf2kPdig9IEIe_IE9vuLSw.s['6']++;this.navBar=new Y.Rednose.Navbar();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['7']++;this.navBar.createDropdown(dropdown,[{title:TEXT_MENU_CHANGE_PASSWORD,url:YUI.Env.routing.change_password},{title:'-'},{title:TEXT_MENU_SIGN_OUT,url:YUI.Env.routing.logout}]);__cov_Qf2kPdig9IEIe_IE9vuLSw.s['8']++;if(Y.one('.libbit-lox-sidenav')){__cov_Qf2kPdig9IEIe_IE9vuLSw.b['1'][0]++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['9']++;Y.one('.libbit-lox-sidenav').plug(Y.Plugin.Affix,{offset:{top:70}});}else{__cov_Qf2kPdig9IEIe_IE9vuLSw.b['1'][1]++;}__cov_Qf2kPdig9IEIe_IE9vuLSw.s['10']++;this._initBadge();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['11']++;this._updateNotifications();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['12']++;this._bindMarkRead();},destructor:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['3']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['13']++;this.navBar.destroy();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['14']++;this.navBar=null;},render:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['4']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['15']++;this.navBar.render();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['16']++;return this;},_initBadge:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['5']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['17']++;var request,ds;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['18']++;ds=new Y.DataSource.IO({source:YUI.Env.routing.notifications_unread});__cov_Qf2kPdig9IEIe_IE9vuLSw.s['19']++;request={callback:{success:function(e){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['6']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['20']++;var count=parseInt(e.response.results[0].responseText,10);__cov_Qf2kPdig9IEIe_IE9vuLSw.s['21']++;Y.one('#badge-notifications').setContent(count>0?(__cov_Qf2kPdig9IEIe_IE9vuLSw.b['2'][0]++,count):(__cov_Qf2kPdig9IEIe_IE9vuLSw.b['2'][1]++,null));}}};__cov_Qf2kPdig9IEIe_IE9vuLSw.s['22']++;ds.setInterval(SHORT_POLLING_INTERVAL*6000,request);},_updateNotifications:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['7']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['23']++;var self=this;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['24']++;Y.io(YUI.Env.routing.notifications,{method:'GET',on:{success:function(tx,r){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['8']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['25']++;var dropdown=Y.one('#notifications-dropdown'),data=Y.JSON.parse(r.responseText),config=[];__cov_Qf2kPdig9IEIe_IE9vuLSw.s['26']++;dropdown.one('.dropdown-menu').empty();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['27']++;Y.Array.each(data,function(item){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['9']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['28']++;config.push({node:Y.Node.create(item.html)});});__cov_Qf2kPdig9IEIe_IE9vuLSw.s['29']++;self.navBar.createDropdown(dropdown,config);}}});},_bindMarkRead:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['10']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['30']++;var dropdown=Y.one('#notifications-dropdown'),self=this;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['31']++;dropdown.on('click',function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['11']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['32']++;Y.io(YUI.Env.routing.notifications_mark_read,{method:'POST',on:{success:function(){__cov_Qf2kPdig9IEIe_IE9vuLSw.f['12']++;__cov_Qf2kPdig9IEIe_IE9vuLSw.s['33']++;self._updateNotifications();__cov_Qf2kPdig9IEIe_IE9vuLSw.s['34']++;Y.one('#badge-notifications').setContent(null);}}});});}});__cov_Qf2kPdig9IEIe_IE9vuLSw.s['35']++;Y.namespace('Lox').Page=Page;},'@VERSION@',{'requires':['node','base','datasource-io','datasource-polling','gallery-affix','io','json','rednose-navbar','view']});
